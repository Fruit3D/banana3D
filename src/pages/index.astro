---
import Layout from '../layouts/Layout.astro';
import CodeBlock from '../components/CodeBlock.astro';
---

<Layout title="banana3D - A Web3D Smart Object Spec">
  <!-- Title Section -->
  <div class="mb-12">
    <h2 class="text-4xl font-bold text-foreground mb-4">
      Specification for a Web3D Package Manager
    </h2>
    <h3 class="text-xl font-semibold text-primary mb-6">
      Build and Share Web3D Interactivity
    </h3>

    <div class="mb-6 rounded-xl border border-accent/50 bg-accent/10 px-4 py-3 flex items-start gap-3">
      <div class="mt-1 text-accent">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          width="20"
          height="20"
          fill="currentColor"
        >
          <path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm0 4a1.25 1.25 0 1 1 0 2.5A1.25 1.25 0 0 1 12 6zm1 4v7h-2v-7h2z" />
        </svg>
      </div>
      <p class="text-sm text-foreground leading-relaxed">
        <span class="font-semibold">Important!</span> This is just an outline specification at the moment - so don't
        try installing just yet! Please
        <a
          href="https://github.com/Fruit3D/banana3D/issues/1"
        >
          provide feedback
        </a>.
      </p>
    </div>

    <p class="text-lg text-muted-foreground leading-relaxed mb-4">
      banana3D is a package manager and specification for packaging reusable Web3D objects. 
      You can bundle Web3D code with a 3D glTF file. This means you can drop Web3D objects
      into any 3D web project and have them "just work".
    </p>
    <p class="text-lg text-muted-foreground leading-relaxed mb-4">
      Web3D objects can be shared via an npm-style registry. Code can be automatically ported between different rendering enginesâ€”AI generates entirely new versions for seamless multi-runtime support.
    </p>
    <p class="text-base text-muted-foreground leading-relaxed">
      A Web3D object is a self-contained package combining a glTF 3D model with the code that makes it interactive. Designed for web and 3D developers who want to create and reuse 3D interactivity with minimum hassle.
    </p>
  </div>

  <section class="mb-12">
    <h2 class="text-2xl font-bold text-foreground mb-4 pb-2 border-b border-border">
      What you can do with banana3D
    </h2>
    <ul class="list-disc pl-5 space-y-1 text-muted-foreground">
      <li>Install reusable Web3D objects into any web project using simple CLI commands.</li>
      <li>Package your own glTF files together with interaction code and configuration.</li>
      <li>Edit, preview, and save object configurations in a browser-based editor.</li>
      <li>Publish and share objects through an npm-style registry for others to reuse.</li>
    </ul>
  </section>

  <!-- Getting Started -->
  <section class="mb-12">
    <h2 class="text-2xl font-bold text-foreground mb-6 pb-2 border-b border-border">
      Getting Started
    </h2>
    <p class="text-muted-foreground mb-4">
      To get started you'll need to have
      <a
        href="https://nodejs.org"
        class="text-primary font-medium"
        target="_blank"
        rel="noopener noreferrer"
      >
        Node.js
      </a>
      installed. 
    </p>
    <p class="text-muted-foreground mb-4">Initially we plan to support "porting" across these runtimes and frameworks:</p>
    <ul class="list-disc pl-5 space-y-1 text-muted-foreground">
      <li>3D runtimes: three.js, A-Frame, babylon.js</li>
      <li>Frontend web frameworks: React, React Three Fiber, React Babylonjs</li>
    </ul>

    <!-- <h4 class="text-lg font-semibold text-foreground mt-8 mb-3">
      Install an example smart object:
    </h4>
    <CodeBlock code={`$ npx b3d install running-shoe
First time installing, let's get you set-up. 
No web stack detected. 
Pick web stack:
 * three.js / vite
 * three.js / react-three-fiber

Setting up 
Installed 
"running-shoe" v1.2.1 installed in the current directory.
Run "npx b3d editor" to start the object editor in a web browser`} />
    <p class="text-muted-foreground mb-4">
      This installs the <span class="font-mono text-sm">running-shoe</span> example into the
      current directory so you can explore how a smart object is structured.
    </p> -->

    <h4 class="text-lg font-semibold text-foreground mt-8 mb-3">
      Initialize a new project:
    </h4>
    <CodeBlock code={`$ npx b3d init
Found package.json
Tech stack discovered:
@react-three/drei ^9.103.0
@react-three/fiber ^8.15.18
three ^0.160.0
Created config file: banana3d.config

Use "npx b3d install [package-name]" to install your first Web3D object`} />
    <p class="text-muted-foreground mb-4">
      This detects your tech stack and automatically configures your project, ready for first use. 
    </p>

    <h4 class="text-lg font-semibold text-foreground mt-8 mb-3">
      Install your first Web3D object:
    </h4>
    <CodeBlock code={`$ cd src/components
$ npx b3d install running-shoe

Created "running-shoe" directory in src/app/components.

"running-shoe" v1.2.1 installed.
Run "npx b3d editor" to start the banana3D editor in a web browser.`} />
    <p class="text-muted-foreground mb-4">
      The code is installed along with the glTF file(s), ready to review. 
    </p>

    <h4 class="text-lg font-semibold text-foreground mt-8 mb-3">
      Start the banana3D editor:
    </h4>
    <CodeBlock code={`$ npx b3d editor
Confirm this is the editor source code:
editor.jsx
Yes (y)
No (n)

Created ./banana3d/editor/

Starting server at: http://localhost:4001`} />
    <p class="text-muted-foreground mb-4">
      This launches a local browser-based editor where you can edit, preview, and save
      configuration for your Web3D objects. If the developer hasn't provided any editing capability - it will just be a viewer. 
    </p>

    <h4 class="text-lg font-semibold text-foreground mt-8 mb-3">
      Publish your object:
    </h4>
    <CodeBlock code={`$ npx b3d login
$ npx b3d search running-shoe
No packages called "running-shoe"
$ npx b3d publish --access public`} />
    <p class="text-muted-foreground mb-4">
      Once you are happy with your object, log in and publish so others can install it from
      the registry like any other package.
    </p>
  </section>

  <!-- Configure your existing project -->
  <section class="mb-12">
    <h2 class="text-2xl font-bold text-foreground mb-6 pb-2 border-b border-border">
      Configure your existing project
    </h2>
    <p class="text-muted-foreground mb-6">
      You've already got your project set-up in a particular way. 
      We'll try and detect your project type and set up the necessary configuration.
      Here are the details if you want to edit yourself. 
    </p>

    <CodeBlock code={`{
  "objects_path": "src/app/components",
  "public_files": "public/"
}`} />
    <div class="bg-secondary/50 rounded-lg p-6 mt-6">
      <p class="text-foreground font-medium mb-3">The config options are:</p>
      <ul class="space-y-2 text-muted-foreground">
        <li><span class="font-mono text-sm text-primary">objects_path</span> - This is where new Web3D interactivity code will be installed</li>
        <li><span class="font-mono text-sm text-primary">public_files</span> - Where glTF files are served from your web project. Any new glTF files will be copied here during installation</li>
      </ul>
    </div>
  </section>

  <section class="mb-12">
    <h2 class="text-2xl font-bold text-foreground mb-6 pb-2 border-b border-border">
      Guidance for creating your first Web3D object
    </h2>

    <div class="grid gap-6 lg:grid-cols-2">
      <div class="bg-secondary/40 rounded-lg p-5">
        <div class="flex items-center gap-2 mb-3">
          <span class="inline-flex h-6 w-6 items-center justify-center rounded-full bg-emerald-500/10 text-emerald-600">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 6 9 17l-5-5" />
            </svg>
          </span>
          <h3 class="text-base font-semibold text-foreground">You must</h3>
        </div>
        <ul class="list-disc pl-5 space-y-2 text-muted-foreground">
          <li>Create a self-contained TypeScript module that exports a function that creates the component to be rendered.</li>
          <li>Follow the banana3D configuration API for reading settings (documentation coming soon).</li>
          <li>Test using <span class="font-mono text-sm">npx b3d editor</span> to make sure it works as expected before publishing.</li>
        </ul>
      </div>

      <div class="bg-secondary/40 rounded-lg p-5">
        <div class="flex items-center gap-2 mb-3">
          <span class="inline-flex h-6 w-6 items-center justify-center rounded-full bg-red-500/10 text-red-600">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M18 6 6 18" />
              <path d="m6 6 12 12" />
            </svg>
          </span>
          <h3 class="text-base font-semibold text-foreground">You must not include code for</h3>
        </div>
        <ul class="list-disc pl-5 space-y-2 text-muted-foreground">
          <li>Scene set-up and environment configuration.</li>
          <li>Scene lighting, except for lighting created within the object itself (for example, a lamp).</li>
          <li>Camera movements.</li>
        </ul>
      </div>
    </div>

   <div class="mt-6 bg-secondary/30 rounded-lg p-5">
      <h3 class="text-base font-semibold text-foreground mb-2">Creating an editor</h3>
      <p class="text-muted-foreground">The only requirement for the editor is to use 
        banana3D's configuration API to enable reading and writing of the banana3d.json file. This 
        API provides functions for loading, modifying, and saving the configuration data.</p>
    </div>

    <div class="mt-6 bg-secondary/30 rounded-lg p-5">
      <h3 class="text-base font-semibold text-foreground mb-2">Useful tools</h3>
      <ul class="list-disc pl-5 space-y-1 text-muted-foreground">
        <li><a href="https://github.com/pmndrs/gltfjsx">gltfjsx</a> for easily generating a <span class="font-mono text-sm">.jsx</span> file based on a glTF file.</li>
        <li><a href="https://github.com/pmndrs/leva/tree/main">Leva</a> for creating a minimal in-browser editor for tweaking configuration values.</li>
      </ul>
    </div>

    <div class="mt-6 bg-secondary/30 rounded-lg p-5">
      <h3 class="text-base font-semibold text-foreground mb-2">Tips</h3>
      <p class="text-muted-foreground">
         If you change the configuration, you can regenerate the Web3D object by running 
         <span class="font-mono text-sm">npx b3d generate [package-name]</span>.
      </p>
    </div>

  </section>

  <!-- How does it work -->
  <section class="mb-12">
    <h2 class="text-2xl font-bold text-foreground mb-6 pb-2 border-b border-border">
      How does it work?
    </h2>
    <p class="text-muted-foreground mb-6">
      An npm-style registry maps package names to runtime implementations. Each package can
      include code for multiple Web3D runtimes (for example, different engines or
      frameworks). AI can be used to generate new runtime adapters for rendering
      engines that do not exist yet.
    </p>
    <p class="text-muted-foreground mb-6">
      Running the editor spins up a web server that hosts the web framework and 3D renderer so 
      the component can be easily tested by itself.
    </p>

    <h4 class="text-lg font-semibold text-foreground mt-8 mb-3">
      Typical folder structure:
    </h4>
    <p class="text-muted-foreground mb-3">
      Here is an example layout for a reusable <span class="font-mono text-sm">shoe</span> Web3D object
      inside your project:
    </p>
    <CodeBlock code={`src/app/components/shoe/
    editor.jsx
    shoe.glb
    shoe.jsx
    banana3d.json
banana3d.package.json
package.json`} />

    <div class="bg-secondary/50 rounded-lg p-6 mt-6">
      <p class="text-foreground font-medium mb-3">The folder contains:</p>
      <ul class="space-y-2 text-muted-foreground">
        <li><span class="font-mono text-sm text-primary">editor.jsx</span> - A development editor to edit settings and save configuration for how the object should look and behave.</li>
        <li><span class="font-mono text-sm text-primary">shoe.glb</span> - The glTF 3D asset file.</li>
        <li><span class="font-mono text-sm text-primary">shoe.jsx</span> - The runtime code that provides interactivity.</li>
        <li><span class="font-mono text-sm text-primary">banana3d.json</span> - Configuration is saved to this file from the editor. It is written into the Javascript file for runtime.</li>
        <li><span class="font-mono text-sm text-primary">banana3d.package.json</span> - Lists dependencies - see example below.</li>
        <li><span class="font-mono text-sm text-primary">package.json</span> - Usual package.json created by npm.</li>
      </ul>
    </div>

    <h4 class="text-lg font-semibold text-foreground mt-8 mb-3">
      Tracking installed Web3D objects
    </h4>
    <p class="text-muted-foreground mb-4">
      banana3d.package.json tracks all installed Web3D objects and any project-wide configuration. 
    </p>
    <CodeBlock code={`{
  "config": {
      "debug": true
  },
  "dependencies": {
    "running-shoe": "^1.2.1"
  }
}`} />

    <h4 class="text-lg font-semibold text-foreground mt-8 mb-3">
      Store configuration for your Web3D objects:
    </h4>
    <p class="text-muted-foreground mb-4">
      Example <span class="font-mono text-sm">banana3d.json</span>, stored in the Web3D object's folder.
    </p>
    <CodeBlock code={`{
  "config": {
    "initial_state": "open",
    "initial_animation": "fold_open"
  }
}`} />
  </section>

  <!-- Request for Comments -->
  <section class="mb-12">
    <h2 class="text-2xl font-bold text-foreground mb-6 pb-2 border-b border-border">
      Request for Comments
    </h2>
    <p class="text-muted-foreground">
      This spec is in active development. Feedback, ideas, or concerns? <a
          href="https://github.com/Fruit3D/banana3D/issues/1"
          >Make a comment here</a>.
    </p>
  </section>

  <!-- FAQs -->
  <section class="mb-12">
    <h2 class="text-2xl font-bold text-foreground mb-6 pb-2 border-b border-border">
      FAQs
    </h2>
    
    <div class="space-y-8">

      <div>
        <h4 class="text-lg font-semibold text-foreground mb-2">
          Why create banana3D?
        </h4>
        <p class="text-muted-foreground">
          Right now, creating and sharing high-quality interactive objects is hard work. We want
          to make reusable interactive objects for everyday items without reinventing the wheel
          each time. banana3D aims to guide developers towards well-structured, portable objects, with
          clearer standards for how we create, edit, and share interactive 3D on the web.
        </p>
      </div>

      <div>
        <h4 class="text-lg font-semibold text-foreground mb-2">
          Can I include many 3D glTF files in my package?
        </h4>
        <p class="text-muted-foreground">
          You can include multiple glTF files in a single package, but we recommend smaller,
          focused packages that are faster to install and easier to maintain.
        </p>
      </div>

      <div>
        <h4 class="text-lg font-semibold text-foreground mb-2">
          How is this different from the glTF Interactivity Extension?
        </h4>
        <p class="text-muted-foreground">
          We are aware of the glTF Interactivity Extension. banana3D explores a different approach
          that embraces simplicity, the npm ecosystem for dependencies, and a structure that
          makes it easy for AI tools to generate and maintain code.
        </p>
      </div>

      <div>
        <h4 class="text-lg font-semibold text-foreground mb-2">
          How are new runtime versions created using AI?
        </h4>
        <p class="text-muted-foreground">
          This is an experimental direction. We still need to work out where the AI code will
          run (locally or on a remote server). The idea is to pass an existing runtime
          implementation and a target engine into an AI system and generate a new adapter.
          The hard part is robust testing to make sure it behaves like the original version.
          Got ideas? Get in touch.
        </p>
      </div>

      <div>
        <h4 class="text-lg font-semibold text-foreground mb-2">
          What if something isn't supported for a particular 3D runtime?
        </h4>
        <p class="text-muted-foreground">
          It will be best effort support. Some features may not translate perfectly to all runtimes,
          but we'll ask the AI to provide equivalent functionality where possible and note 
          when changes have been made. 
        </p>
      </div>

    </div>
  </section>
</Layout>
